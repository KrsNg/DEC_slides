\documentclass{beamer}


% PACKAGES==========================================================================================
\usepackage{hyperref}
\usetheme[hideothersubsections]{PaloAlto}
\useinnertheme{rectangles}
\usecolortheme{beaver}
\usepackage[version=3]{mhchem}
\usepackage{caption}
\usepackage{textpos}
\usepackage{amsmath,esint}
\usepackage{siunitx}
\usepackage{etoolbox}
\usepackage{wrapfig}
\usepackage{multicol}
\usepackage[caption=false]{subfig}
\usepackage{chngcntr}
\counterwithin{figure}{subsection}
%\usepackage[font=small,skip=0pt]{caption}


% SETTINGS==========================================================================================
\setbeamerfont{caption}{series=\normalfont,size=\fontsize{5}{5}}
\setbeamercolor{section in sidebar}{fg=black}
\setbeamercolor{section in sidebar shaded}{fg=lightgray}%section in sidebar.fg!40!bg}
\setbeamercolor{subsection in sidebar}{fg=darkred}         %color of the active subsection
\setbeamercolor{subsection in sidebar shaded}{fg=darkgray}  %color of the inactive subsection
\setbeamercolor{title in sidebar}{fg=black}              %color of the presentation title
\setbeamertemplate{itemize items}{\scalebox{0.9}{\text{\textbullet}}} 

\makeatletter
\@addtoreset{subfigure}{framenumber}% subfigure counter resets every frame
\makeatother

\makeatletter
\patchcmd{\insertverticalnavigation}%
{\ifx\beamer@nav@css\beamer@hidetext{\usebeamertemplate{section in sidebar}}\else{\usebeamertemplate{section in sidebar shaded}}\fi}%
{{\usebeamertemplate{section in sidebar}}}{}{}
\makeatother 
 
 
\setbeamerfont{block body}{size=\tiny}
%\setbeamertemplate{blocks}[square][shadow=false]
\setbeamertemplate{blocks}[default]
\setbeamertemplate{bibliography item}[text]
\setlength{\parindent}{0pt}
\setbeamertemplate{caption}[numbered]


\defbeamertemplate*{section in toc}{my theme}
{\leavevmode\leftskip=0.5em\large{\usebeamercolor[fg=darkred]{titlelike}\inserttocsectionnumber.} \inserttocsection\par}

\defbeamertemplate*{subsection in toc}{my theme}
{\leavevmode\leftskip=0.5em\normalsize{\usebeamercolor[fg=darkgray]{titlelike}\inserttocsectionnumber.\inserttocsubsectionnumber.} \inserttocsubsection\par}



% Define footer
\setbeamertemplate{footline}{bg=primary}
\makeatother
\setbeamertemplate{footline}
{
    \leavevmode%
    \hbox{%
    \begin{beamercolorbox}[wd=.4\paperwidth,ht=2.25ex,dp=1ex,center]{author in head/foot}%
       \usebeamerfont{author in head/foot}\insertshortauthor\ (Chris Ngigi - DEC I)
    \end{beamercolorbox}%
    
    \begin{beamercolorbox}[wd=.4\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
        \usebeamerfont{title in head/foot}\insertshorttitle
        \hfill
    \end{beamercolorbox}    
        
    \begin{beamercolorbox}[wd=.2\paperwidth,ht=2.25ex,dp=1ex,center]{title in head/foot}%
        \usebeamerfont{title in head/foot}
        \hfill    
        \hspace{2em}\insertframenumber/\inserttotalframenumber
    \end{beamercolorbox}}%
}

\beamertemplatenavigationsymbolsempty  % disable navigation
\setbeamertemplate{sidebar}{%
   \vspace*{0cm}
    \vspace*{\fill}
   \vspace*{0.1cm}
   \setbeamersize{sidebar width left=2cm}
   \includegraphics[width=0.55cm]{./figs/utias_logo_blue.jpg}
}
    
\setbeamerfont{section number projected}{family=\rmfamily,series=\bfseries}
\setbeamercolor{section number projected}{bg=lightgray,fg=darkred}
\setbeamertemplate{sections/subsections in toc}[square]

\addtobeamertemplate{frametitle}{}{%
\begin{textblock*}{1cm}(-1.8cm,-1.2cm)
\includegraphics[height=1cm,width=1cm]{./figs/utias-logo2.jpg}
\end{textblock*}}

\makeatletter
\patchcmd{\beamer@sectionintoc}{\vskip1.5em}{\vskip0.5em}{}{}
\patchcmd\insertverticalnavigation{\dohead}{\vskip-35pt\dohead}{}{}
\makeatother


%===================================
% include the user-defined commands
%===================================
%\include{commands_ltn}



% ==================================================================
% NOW MAIN DOCUMENT

%%========================================================================

\title[]{Development of $h$-$p$ adjoint-based error estimation for LES of reactive flows }
\author[]{{Christopher Ngigi \texorpdfstring{\\ \tiny{Ph.D. Candidate} \\} \footnotesize Supervisor: Prof. C. P. T. Groth}}
\titlegraphic{\includegraphics[width=0.15\textheight]{./figs/utias_logo_blue.jpg}}
\institute[]{Doctoral Examination Committee \\ Meeting I \\ University of Toronto, Institute for Aerospace Studies}
\date[]{April 6, 2015}
	
%%========================================================================

\begin{document}

\addtocounter{framenumber}{-1}
\begingroup
\makeatletter
\setlength{\hoffset}{-.5\beamer@sidebarwidth}
\makeatother
\begin{frame}[plain]
    \titlepage	
\end{frame}
\endgroup
%==========================================================================================
%\begin{frame}[plain,c]
%\centering
%\begin{minipage}[t][1\textheight]{1\textwidth}
%\begin{alertblock}{\large{Outline: }}
%\small
%
%\tableofcontents[hideallsubsections]
%
%\end{alertblock}
%\end{minipage}
%\end{frame}


%===========================================================================================

% this section adds a mini TOC between sections. CTRL+U to activate
%\AtBeginSection[]
%{
%     \begin{frame}[plain,c]
%     \begin{minipage}[t][1\textheight]{0.8\textwidth}
%     %\setbeamercolor{section in toc shaded}{use=structure,fg=lightgray}
%     \setbeamercolor{section in toc}{fg=darkred}
%     \setbeamercolor{subsection in toc}{fg=darkgray}
%          
%     %\includegraphics[width=1.5cm]{./figs/utias_logo_blue.jpg}
%     \begin{alertblock}{\large{Section:}}
%     \tiny
%     \tableofcontents[currentsection, sectionstyle=show/shaded, subsectionstyle=show/show/hide]
%     \end{alertblock}
%     \end{minipage}
%     \end{frame}
%}

%==========================================================================

\section{Introduction}
\subsection{Computing power}
\begin{frame}%[allowframebreaks]
\frametitle{Introduction}
\vspace{-6pt}
\scriptsize 
\begin{enumerate}[(a)]
\setlength\itemsep{0.65em}
\item Computational Fluid Dynamics (CFD): help reduce time \& cost of prototype design for engineering systems 
\item Corresponding experiments: can be expensive (time, resources) to conduct
\item CFD: developed to capture complex phenomena to varying extents of accuracy
\item Computing power $\approx$ doubles per 2 years. Costs less to do more?
\vspace{-15pt}
\begin{figure}[h!]
%\centering
\subfloat[\tiny{Moore's Law over the years [BCA Blog] \cite{MooreLaw}]} \label{fig:contourDNS}]{\includegraphics[height=0.4\textwidth, trim=0cm 1.2cm 0 1.2cm,clip=true]{./figs/MooresLaw.png}}
\label{fig:Moore}
\end{figure}
\end{enumerate}
\end{frame}

%==========================================================================

\subsection[experimental]{Turbulent combustion - experimental}
\begin{frame}%[allowframebreaks]
\frametitle{Turbulent combustion - Example flame}
\scriptsize
[K{\"o}hler 2006] \cite{Kohler, AdelaideISF}
\begin{minipage}[0.5\textheight]{\textwidth}
\begin{columns}[T]
\begin{column}{0.65\textwidth}
\vspace{10pt}

\tiny{Lifted turbulent Ethylene ($C_2H_4$) jet flame issuing into a concentric co-flow of air.
Zone between flame-base and nozzle may have partial premixing.  }
\begin{itemize}%[<+->]
\tiny
\item Dimensions: nozzle diameter = 2.0 mm; co-flow air annulus diameter = 140 mm\\
\item Exit fuel Reynolds number: $\num{10e3}$
\end{itemize}
\end{column}
\begin{column}{0.3\textwidth}
\vspace{0pt}
\includegraphics[height=0.7\textwidth]{./figs/dlrflame.png}
\end{column}
\end{columns}
\end{minipage}

\vspace{10pt}
\scriptsize
Turbulent combustion: practical reactive flows almost always involve turbulence.
\newline \newline
Simulation techniques: 
\begin{enumerate}[(a)]
\item DNS resolves all the scales 
\item LES models sub-filter scales (SFS) while resolving larger scales 
\item RANS models all turbulent scales 
\end{enumerate}
Large eddy simulation (LES): higher accuracy than Reynolds averaged Navier Stokes (RANS) $\rightarrow$ lower cost (time, resources) than direct numerical simulation (DNS).


\end{frame}

%==========================================================================

\subsection[simulation]{Turbulent combustion - simulation}
\begin{frame}%[allowframebreaks]
\frametitle{Turbulent combustion - LES \& DNS comparison}
\scriptsize
Comparison of DNS and LES by Yang, Pope and Chen [2013]\cite{Pope}: turbulent Ethylene jet flame in co-flow

\vspace{-15pt}
\begin{figure}
\label{fig:DNSLES}
\centering
\subfloat[\tiny{temperature in $x$-$y$ plane: DNS (L), LES/PDF (R)} \label{fig:contourDNS}]
{\includegraphics[width=0.9\textheight]{./figs/Temperatures.png}}
\end{figure}

\end{frame}

%--------------------------------------------------------------------

\begin{frame}%[allowframebreaks]
\frametitle{Turbulent combustion - LES \& DNS comparison cont'd}
Numerical setup of Yang, Pope and Chen [2013]:\newline
\tiny{$H = 2$ mm is the jet width, computational domain $=$ cuboid}\newline
\scriptsize
DNS: 
\begin{enumerate}[(1)]
\scriptsize
\item Grid points $ = 1.3 \times 10^9$.  
\item Computational cost $\approx 14 \times 10^6$ CPU hours. ($10^6$ hrs = $114$ years)
\end{enumerate}
LES:
\begin{enumerate}[(1)]
\scriptsize
\item Grid points $ \approx 83 \times 10^3$.  
\item Cost not specified - expected to be several orders of magnitude \textit{lower}.
\end{enumerate}
\vspace{0pt}

\begin{minipage}[0.5\textheight]{\textwidth}
\begin{columns}[T]
\hspace{-10pt}
\begin{column}{0.7\textwidth}
\vspace{-20pt}
\begin{figure}
\centering
\subfloat[\tiny{Mean temperature: DNS and LES} \label{fig:meanTemp}]
{\includegraphics[width=0.7\textheight]{./figs/Temp_DNS_LES2.png}}
\end{figure}


\end{column}
\hspace{-30pt}
\begin{column}{0.5\textwidth}
\vspace{20pt}
\tiny
Mean temperature results:
\begin{enumerate}[(a)]
\item agreement between LES and DNS at $x = 6H$. 
\item LES values lower than DNS for $x = 12H$. 
\item Anticipate improvement for increased LES mesh resolution.
\end{enumerate}

\end{column}
\end{columns}
\end{minipage}

\end{frame}


\section[Error]{Overview of error in CFD}
\begin{frame}%[allowframebreaks]
\frametitle{Overview of error in CFD}
\vspace{0pt}
\begin{minipage}[t][1.1\textheight]{1\textwidth}
\scriptsize
\vspace{-20pt}
\begin{exampleblock}{Likely sources of error}
\vspace{-20pt}
\begin{figure}[h!]
\subfloat[\tiny{Some sources of error [Fidkowski 2012]}\label{fig:Fidk}]
{\includegraphics[height=0.64\textwidth]{./figs/Error.png}}
\end{figure}
\end{exampleblock}
\end{minipage}
\end{frame}


\subsection{Types of error in CFD}
\begin{frame}%[allowframebreaks]
\frametitle{Types of error in CFD}
\scriptsize
We can broadly classify the two key sources of error in CFD as follows:

\begin{enumerate}[1.]
\item Numerical error:
	\begin{enumerate}[(a)]
	\scriptsize
	\item Solution error - between exact value and the CFD-obtained value
	\item Truncation error - actual governing equations PDEs and the discretized form of the numerical scheme
	\item Convergence error - nature of the iterative technique used
	\end{enumerate}
\item Modeling error:
	\begin{enumerate}[(a)]
	\scriptsize
	\item Sub-filter scale turbulence model: inappropriate model selected
	\item Combustion and chemistry model
	\item Aliasing errors - decomposed nonlinear terms in FANS = feedback of frequencies beyond filter bandwidth, = 'fake' stresses 
	\item Commutation errors - exist between filtering and differential operations 
	\end{enumerate}
\end{enumerate}

\end{frame}



\subsection{Techniques for controlling numerical error}
\begin{frame}%[allowframebreaks]
\frametitle{Techniques for controlling numerical error}
\scriptsize
We can control numerical error in CFD using a combination of:

\begin{enumerate}[1.]
\item Mesh refinement
	
\item High-order discretizations (space and time)
	
\end{enumerate}

\end{frame}










%==========================================================================

\section[AMR]{Adaptive mesh refinement}

\subsection[AMR types]{Common AMR strategies}
\begin{frame}%[allowframebreaks]
\frametitle{Common adaptive mesh refinement (AMR) strategies}
\tiny
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-15pt}
\begin{exampleblock}{Key characteristics}
[Northrup 2013]
\vspace{-20pt}
\begin{figure} \label{fig:AMRtypes}
\centering
\subfloat[\tiny{flagged cells} \label{fig:flag}]
{\includegraphics[width=0.339\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/flagged_cells.jpg}}
\subfloat[\tiny{Cell-based refinement} \label{fig:cell-b}]
{\includegraphics[width=0.339\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/cell-based-refine.jpg}}
\subfloat[\tiny{Patch-based refinement} \label{fig:patch-b}]
{\includegraphics[width=0.339\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/patch-based_refine.jpg}}
\subfloat[\tiny{Block-based refinement} \label{fig:block-b}]
{\includegraphics[width=0.339\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/block-based.jpg}}
\end{figure}

\vspace{5pt}
\begin{itemize}
\tiny
\item Cell based: [Powell et al, 1993] [Berger and Leveque, 1989] [Aftosmis et al, 1998] \newline Cells refined individually, hierarchy stored in a (very dense) tree

\item Patch based: [Berger and Collela, 1989] \newline Cells are organized into collections of rectangular patches

\item Block based:  [Groth and co-workers, 1999, 2005, 2011, 2013, 2015] [Berger, 1994 ] \newline Entire blocks get refined, much lighter tree structure, efficient domain decomposition
\end{itemize}
\end{exampleblock}
\end{minipage}

\end{frame}






\subsection{Basis}
\begin{frame}%[allowframebreaks]
\frametitle{AMR: isotropic and anisotropic}
\tiny
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-15pt}
\begin{exampleblock}{Key characteristics of AMR}
[Groth et al 1999, 2005, 2011, 2013, 2015]
\begin{itemize}
\tiny
\item localized refinement, large variation of scales, easily automatable
\item Benefits of AMR: overall large computational cell count savings
\end{itemize}
\vspace{-20pt}
\begin{figure}
\label{fig:cubeAMRbased}
\centering
\subfloat[\tiny{Cell refinement strategies on a reference uniform mesh: [Zhang 2011]} \label{fig:blockdiv}]
{\includegraphics[width=0.95\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/BlockDivision.jpg}}
\end{figure}
\end{exampleblock}
\end{minipage}

\end{frame}


%---------------------------------------------------------------------------------
\subsection{Block based AMR}
\begin{frame}%[allowframebreaks]
\frametitle{Benefits: anisotropic vs isotropic AMR}
\tiny
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-15pt}
\begin{exampleblock}{Key characteristics}
\vspace{-20pt}
\begin{figure}
\label{fig:cubeAMRbased}
\centering
\subfloat[\tiny{With Anisotropic AMR. 5522 (8x8x8) blocks [Freret 2015]} \label{fig:cubeIso}]
{\includegraphics[width=0.6\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/shockCubeAniso3.jpg}}
\subfloat[\tiny{With isotropic AMR. 7036 (8x8x8) blocks [Freret 2015]} \label{fig:cubeAniso}]
{\includegraphics[width=0.6\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/shockCubeIso3.jpg}}
\end{figure}
\vspace{-15pt}
\begin{itemize}
\tiny
\item For the above shockcube cases, cell count ratio of anisotropic $:$ isotropic $\approx 0.72$ thus reflecting approximately $28 \%$ reduction in number of cells
\item Williamschen [2013] previously obtained savings of up to $85 \%$ reduction in cell count for 3D meshes for inviscid flows
\end{itemize}
\end{exampleblock}
\end{minipage}

\end{frame}



%---------------------------------------------------------------------------------------




%---------------------------------------------------------------------------------------

\subsection{Characteristics}
\begin{frame}%[allowframebreaks]
\frametitle{Block-based AMR}
\tiny
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-15pt}
\begin{exampleblock}{Key characteristics}
Block-based AMR: [Groth and co-workers 1999, 2005, 2006, 2010, 2011, 2012, 2013] \newline

\begin{itemize}
\tiny
\item Entire block gets refined, along with all its cells. 
\item This approach is much cheaper than individual cell refinement, having a lighter tree structure.
\item How the block-based technique works; ghost cells for intercommunication 
\item Parallelizable, low memory and storage requirements
\item New non-uniform approach [Freret 2015]
\end{itemize}

\vspace{-15pt}
\begin{figure}
\label{fig:Blockbased}
\centering
\subfloat[\tiny{Ghost cells on 8 blocks [Rashad 2009]} \label{fig:2dcomm}]
{\includegraphics[width=0.4\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/ghostblock.png}}
\subfloat[\tiny{Parallelization [Northrup 2013]} \label{fig:parall}]
{\includegraphics[width=0.4\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/parallel-domain-decomp.eps}}
\subfloat[\tiny{Non-uniform approach [Freret 2015]} \label{fig:nonUni}]
{\includegraphics[width=0.55\textheight, trim=2cm 0cm 1cm 0cm,clip=true]{./figs/Non-UniformBlock.png}}
\end{figure}
\vspace{-15pt}
\end{exampleblock}
\end{minipage}

\end{frame}





%==========================================================================

\section[FVM]{High order FVM, CENO and LES}
\subsection{High order FVM}
\begin{frame}%[allowframebreaks]
\frametitle{High order FVM and CENO}
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\tiny
\begin{block}{Integral Form of the Governing Equations}
\vspace{-5pt}
     \[
      \frac{\mathrm{d}\overline{\mathbf{U}}}{\mathrm{d}t} = 
      - \frac{1}{V} \oiint_A \left( \vec{\mathcal{F}}^{\rm I} - 
      \vec{\mathcal{F}}^{\rm V} \right) \cdot \hat{n} \mathrm{d}\mathcal{A} + 
      \overline{\mathbf{S}}
     \] 
    \vspace{-5pt} 
    Using a two-dimensional Gauss-Legendre quadrature integration rule:
    \[  \frac{\mathrm{d}\overline{\mathbf{U}}_{ijk}}{\mathrm{d}t} = -
       \frac{1}{{V}_{ijk}} \sum_{l=1}^{N_f}     
      \sum_{m=1}^{N_{GF}} \left( \omega \left(\vec{\mathcal{F}^{\mathrm{I}}} - 
      \vec{\mathcal{F}^{\mathrm{V}}} \right)\cdot \hat{n} {A} \right)_{ijk,l,m} 
      + \sum_{n=1}^{N_{GV}} \left( \omega_n {\mathbf{S}} \right)_{i,j,k,n}      
       = \overline{\mathbf{R}}_{ijk}  \left( \overline{\mathbf{U}} \right) \]
\vspace{-10pt} 
\end{block}
\vspace{-5pt}
\begin{enumerate}[1.]
\tiny
\item High order: $ > 2^{nd}$ order. Error (Governing equations : discretized formulations) $\downarrow$, ($N_G, N_F \uparrow$, more $\omega$)
\item Quadrature rules $\rightarrow$ reference elements $\rightarrow$ computational elements via mapping functions
\end{enumerate}
\vspace{-26pt}
\begin{figure}
\label{fig:h_order_error}
%\centering
\hspace{-40pt}
\subfloat[\tiny{Example of quadrature points on the cell faces} \label{fig:errorHO}]
{\includegraphics[width=0.4\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/fig_quadpts.png}}
\:
\vspace{0pt}
\subfloat[\tiny{L1 error norm, unsteady advection equation. N = total mesh count} \label{fig:errorHO}]
{\includegraphics[width=0.55\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/error_ho_amr3.jpg}}
\end{figure}

\end{minipage}


\end{frame}

%---------------------------------------------------------------------------------

\subsection{CENO}
\begin{frame}
\scriptsize
\frametitle{High order FVM and CENO cont'd} 

\begin{minipage}[t][1\textheight]{1\textwidth}
\scriptsize

\begin{enumerate}[1.]
\setcounter{enumi}{2}
\item Discretized scheme expressed in matrix-vector form.
\item Evaluate the inviscid and viscous fluxes: apply weights to quadrature points
\item Evaluate source vector, which adds effects of turbulence and chemistry in reacting flows
\item Apply appropriate time-marching, e.g. RK4 suitable to high order methods.
\item Other groups researching high order methods in LES: Ihme (Stanford) and Poinsot (CERFACS)
\end{enumerate}

\textbf{Central essentially non-oscillatory (CENO)} scheme implementation:\newline
[Ivan and Groth 2011, 2012]
\begin{itemize}
\item Reconstruction: FVM technique is cell centered. May need state values on faces (flux evaluations), quadrature points (high-order)
\item CENO uses fixed stencil for reconstruction
\item CENO eliminates oscillations typical of shocks \& discontinuities
\item smoothness indicators used to select between high order (p) or piecewise linear reconstruction
\end{itemize}
\vspace{-20pt}
\end{minipage}

\end{frame}

%------------------------------------------------------------------------------


\section{LES}
\begin{frame}
\frametitle{Large Eddy Simulation (LES)}
\scriptsize
\begin{minipage}[t][1\textheight]{1\textwidth}
[Piomelli 1999][Ghosal and Moin 1999]
\begin{enumerate}[1.]
\scriptsize
\setlength\itemsep{0.3em}
\item LES utilizes a spatial filtering of a given width, $\bar{\Delta} $. 
\item Any scales smaller than  $\bar{\Delta} $  are modeled $\rightarrow$ sub-filter scales (SFS) \newline {\tiny{[Smagorinsky 1963][Germano 1991][Piomelli 1991][Ghosal and Moin 1999][Lilly 1992]}}
\item Scales larger than $\bar{\Delta}$ are fully resolved.
\item Need appropriate balance for accuracy, $\rightarrow$ modeling error. 
\item Types of filters broadly categorized into:\par
\begin{enumerate}[(a)]
\tiny
\vspace{-2pt}
\item {\scriptsize{\textbf{\textit{Implicit filtering}} {\tiny{[Aspden et al 2008]}}}}
\begin{itemize}

\item Filter width not fixed: inherently related to grid resolution
\item Difficult to compare results of adapted/refined meshes and control aliasing and commutation errors
\end{itemize}

\vspace{-2pt}
\item {\scriptsize{\textbf{\textit{Explicit filtering}} {\tiny{[Vasilyev et al, 1998] [Deconinck, 2008]}}}}
\begin{itemize}

\item Define $\bar{\Delta} $ to fixed for the entire mesh: easily comparable for different meshes
\item Order of truncation errors can be controllable to same order of commutation errors
\item Allows control of aliasing errors
\end{itemize}

\end{enumerate}

\end{enumerate}
\end{minipage}

\end{frame}


%==========================================================================





%===== ADJOINT ============================================================
\section[Error estimates]{Error estimation}

\subsection{Foundation}
\begin{frame}
\frametitle{Foundation for error estimation}
\scriptsize
Two general types of error estimation:
\begin{enumerate}[1.]
\item \textit{a priori} error estimators:  predict long-term behavior of the errors. 
\item \textit{a posteriori} error estimators: use simulation results to derive estimates of solution errors and guide adaptive schemes.
\end{enumerate}

Where calculated error estimates are higher than set threshold:
\begin{itemize}
\scriptsize
\item Mesh can be locally refined ($h$-refinement) while coarsening the less critical areas to save on computational cost. 
\item Degree of polynomial representation can be raised ($p$-refinement)
\end{itemize}

Two main \textit{a posteriori} approaches are:
\begin{enumerate}[(a)]
\scriptsize
\item gradient-based: [Bibb et al, 2006] [Giles and Pierce, 2000]
\item adjoint-based: [Giles and Pierce, 2000][Venditti and Darmofal - 2000,2002][Fidkowski and Darmofal, 2011] 
\end{enumerate}

\end{frame}


\subsection[Gradient]{Background on gradient/physics-based refinement}
\begin{frame}%[allowframebreaks]
\scriptsize
\frametitle{Gradient/physics-based refinement}
Where rates of change of (physical) solution variables are highest, mesh refinement can be applied, or the scheme order can be increased.

\begin{enumerate}[(a)]
\item Thus have enough cells to capture solution changes $\rightarrow$ represent them as \textit{smoothly} as possible.
\item Re-iterate solution to establish new gradients. Changes are again made as necessary. 
\item Error can be compared to a higher $h$-refinement solution.
\item This is the present utility in the anisotropic and isotropic AMR functionality of the CFFC code used by the CFD and Propulsion group.
\item Main disadvantages of the gradient based approach is the lack of continual reduction of solution error with continued $h$-refinement - see next slide
\end{enumerate}
\end{frame}

%-----------------------------------------------------------------
\subsection[example]{CFFC example}
\begin{frame}
\frametitle{Limitation of gradient-based mesh refinement}
\scriptsize
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-10pt}
\begin{exampleblock}{Physics as criteria for mesh coarsening/refinement - sphere with a bow shock example}
\vspace{-20pt}
\begin{figure}
\label{fig:Gradientbased}
\centering
\subfloat[\tiny{With isotropic AMR} \label{fig:sphereIso}]
{\includegraphics[width=0.45\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/outflowIso.png}}
\subfloat[\tiny{With anisotropic AMR} \label{fig:sphereAniso}]
{\includegraphics[width=0.45\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/outflowAniso.png}}
\subfloat[\tiny{Error in the density norm} \label{fig:rhoError}]
{\includegraphics[width=0.45\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/outflowError.png}}
\end{figure}

[Freret, 2015] and [Williamschen, 2013]
\begin{itemize}
\item The graph reveals the asymptotic behavior of the convergence, yet for increased number of cells, there should be continual reduction in the density error norm
\end{itemize}
\end{exampleblock}
\end{minipage}

\end{frame}



\subsection[Adjoint]{Solution adjoint}
\begin{frame}%[allowframebreaks]
\frametitle{Solution adjoint}
\begin{enumerate}[(a)]
\scriptsize
\item Make error estimation more relevant for engineering applications
\item Assess error in predicting an \textit{integral quantity representation} of an engineering output (the functional): e.g. average pressure on a wall. 
\item Adjoint technique is a sensitivity analysis. Measures rates of change of a design functional to a given change in the input. 
\end{enumerate}
\end{frame}

%========================================================================

\subsection[Adjoint formulation]{Solution adjoint fomrulation}
\begin{frame}%[allowframebreaks]
\frametitle{Solution adjoint formulation}
Two main formulations
\newline \tiny{[Giles and Pierce: 1997,2001][Jameson, 2001][Venditti and Darmofal, 2000, 2002] [Becker and Rannacher: 2001,2003]}:
\begin{enumerate}[1.]
\item \scriptsize{\textit{Continuous}}:
\begin{itemize} 
\scriptsize
\item Objective function formed to enforce the flow conditions (i.e. primal nonlinear PDEs). 
\item Applying linear perturbations to primal flow variables
\item Then obtains analytical adjoint equations. Apply relevant b.c.s, and discretize
\end{itemize}
\item \scriptsize{\textit{Discrete}}: 
\begin{itemize}
\scriptsize
\item Apply linear perturbations to nonlinear discrete residual equations from primal problem
\item If adjoint consistent (discrete adjoint = continuous adjoint), no need for b.c. specification $\rightarrow$ automatically incorporated via the primal residual.   
\item thus obtain a linear system of equations - only need linear sensitivities of the functional and the Jacobian matrix associated with the primal residual.
\end{itemize}
\end{enumerate}
\end{frame}

%=========================================================================

\section[Methodology]{Methodology}
\begin{frame}%[allowframebreaks]
\frametitle{Scope \& proposed methodology within existing framework}
\scriptsize
\vspace{-10pt}
\begin{enumerate}[1.]
\item Reducing numerical error: using high order CENO and adjoint based error estimation : {$\mathcal{O}(h^p)$} $\rightarrow$ $h$ and $p$ adaptation

\item Combustion modeling:
  \begin{itemize}
   \tiny
   \item PCM-FPI: allowing detailed chemical kinetics via tabulation of precomputed laminar premixed flames [H. Perez 2011]
   \end{itemize}  


\item Favre-filtered Navier Stokes governing equations

\item Large Eddy Simulation:
  \begin{itemize}
  \tiny
   \item Explicit Filtering [Deconinck 2008]
   \item Sub-filter scale (SFS) modeling [H-Perez 2011]
  \end{itemize}

\item High-order finite volume methods: CENO technique - benefits of higher accuracy on a coarse mesh [Groth and Ivan 2013][Ivan 2010][Rashad 2009]


\item AMR
   \begin{itemize}
   \tiny
   \item Block-based AMR: speed and parallelization [Groth et al 1999]
   \item Anisotropic vs Isotropic: how cell count (computational cost) can be reduced [Zhang 2011][Williamschen 2013][Freret 2015]
   \item Now the non-uniform vs the uniform block modification [Freret 2015]
   \end{itemize}
   
\item Develop a framework for the adjoint based error estimation with $h$-$p$ AMR and CENO
\end{enumerate}
\end{frame}


%===============================================================================

\section{Discrete adjoint}
\begin{frame}
\frametitle{Discrete adjoint}
\scriptsize
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-15pt}
\begin{exampleblock}{Discrete Adjoint}
\vspace{-8pt}
\[\left( \frac{\partial{\mathbf{R}}}{\partial{\mathbf{U}}} \right)^T ~\Psi~ = -\left( \frac{\partial{\mathbf{J}}}{\partial{\mathbf{U}}} \right)^T\]
\text{Linear system of equations in the form:}
\vspace{-10pt}
\[\mathbf{Ax} = \mathbf{b}\]\text{where:} % \vspace{-5pt}
%\vspace{-10pt}
\begin{itemize}
\tiny
\item \textbf{$\mathbf{J}$} = the functional
\item \textbf{$\mathbf{R}$} =  the residual
\item \textbf{$\mathbf{\Psi}$} = the adjoint vector
\end{itemize}
\end{exampleblock}

\vspace{0pt}
Methods to evaluate the matrix $\frac{\partial{\mathbf{R}}}{\partial{\mathbf{U}}} $  for the discrete adjoint:
\vspace{2pt}
\begin{enumerate}[1.]
\tiny
\item Differentiation by hand  - using the inbuilt functions within CFFC code [Northrup, 2013]
\item Finite differencing - perturbing the state U to evaluate R 
\item Automated differentiation - tools that evaluate the differential [Bischof et al: 1992, 1996, 2008]
\item Complex step [Martins, Alonso and Sturdza: 2003]
\end{enumerate}
\end{minipage}


\end{frame}


%=====================================================================

\section[$\Psi$ with h]{Basis of refinement: h and p}

\subsection[Estimation]{Error estimation indicators}
\begin{frame}
\scriptsize
\frametitle{Error estimation indicators}

A method to reduce discretization errors based on the mesh resolution.
\tiny{[Venditti and Darmofal 2000][Fidkowski and Darmofal 2011]}
\begin{enumerate}[(a)]
\scriptsize
\item Consider 2 levels of mesh resolution: coarse (H) and fine (h). Calculate the state ($\mathbf{U}_H$) and functional ($\mathbf{J}_H(\mathbf{U}_H)$) on coarse space. Residual, $\mathbf{R}_H(\mathbf{U}_H) = 0$
\item To evaluate functional on the fine space, $\mathbf{J}_h(\mathbf{U}_h)$ is expensive. Use prolongation operator ($\mathbf{U}_h^H = I_h^H \mathbf{U}_H$) to inject coarse space state onto fine space state.
\item Output error, $\delta \mathbf{J} \equiv \mathbf{J}_H(\mathbf{U}_H) - \mathbf{J}_h(\mathbf{U}_h) \neq 0$
\item Expect new residual, $\mathbf{R}_h(\mathbf{U}_h^H) \neq 0$ 
%\item Injected coarse state solves: $ \mathbf{R}_h(\mathbf{U}_h^\prime) - \mathbf{R}_h(\mathbf{U}_h^H) = 0 \rightarrow (\mathbf{U}_h^\prime) = (\mathbf{U}_h^H)$
\item Using the definition of the fine space adjoint, the error estimate = $ \delta \mathbf{J} \approx  \mathbf{J}_h(\mathbf{U}_h^H) - \mathbf{J}_h(U_h) = \mathbf{\Psi}_h^T \delta \mathbf{R}_h = -\mathbf{\Psi}_h^T \mathbf{R}_h(\mathbf{U}_h^H)   $
\item Error estimate is the value of $\delta \mathbf{J}$, and does not need evaluation of $U_h$, primal solution on the fine space. Can use this error estimate as a flag for refinement, given some threshold value
%\item Steady vs unsteady adjoints: for unsteady, march forward in time, evaluating $\psi$, then march backwards in time. Now have all the sensitivities. Use this to refine the mesh at those time levels. Check set tolerance and repeat until convergence.
\end{enumerate}

\end{frame}


\subsection{Other groups}
\begin{frame}%[allowframebreaks]
\frametitle{Adjoint as basis of mesh refinement: $\mathcal{O}(h)$}
\scriptsize
Extensive literature from groups researching \textbf{adjoint with AMR}
\begin{enumerate}[1.]
\item Becker and Rannacher [2001] - An Optimal Control Approach to a Posteriori Error Estimation in Finite Element Methods
\item Fidkowski and Darmofal [2011] - Review of Output-Based Error Estimation and Mesh Adaptation in Computational Fluid Dynamics
\item Hartmann [2006] - Error Estimation and Adjoint-based Adaptation in Aerodynamics
\item Nemec and Aftosmis [2007] - Adjoint Error Estimation and Adaptive Refinement for Embedded-Boundary Cartesian Meshes
\item Nemec, Aftosmis, and Wintzer [2008] - Adjoint-Based Adaptive Mesh Refinement for Complex Geometries
\item Hartmann, Held and Leicht [2010] - Adjoint-based error estimation and adaptive mesh refinement for the RANS and k-ω turbulence model equations
\item Woopen, May and Sch{\"u}tz [2013] - Adjoint-Based Error Estimation and Mesh Adaptation for Hybridized Discontinuous Galerkin Methods
\item Li, Allaneau and Jameson [2011] - Continuous Adjoint Approach for Adaptive Mesh Refinement
\item Diskin and Yamaleev [2011] - Grid Adaptation Using Adjoint-Based Error Minimization
\end{enumerate}
\end{frame}

%-----------------------------------------------------------------



%==========================================================================
\section[Usage]{Usage}

\begin{frame}%[allowframebreaks]
\frametitle{\LARGE Extension to order increment {$\mathcal{O}(h^p)$}}
\begin{minipage}[t][1\textheight]{1\textwidth}
\scriptsize
\vspace{-10pt}
\vspace{-10pt}
\hspace{10em}
\begin{exampleblock}{Launch abort vehicle example, [Nemec et al, 2008]}
\tiny
Functional as a linear combination of normal and axial forces. $M = 1.1; \alpha=-25\deg$
\vspace{-10pt}

\begin{figure}
\label{fig:LAVone}
\centering
\subfloat[\tiny{Adjoint of density with accompanying error estimate} \label{fig:LAVerror}]
{\includegraphics[width=0.64\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/LAV_adj_err.png}}
\subfloat[\tiny{Final obtained mesh. Initial was $3.7x10^3$ cells; final $2x10^6$ cells } \label{fig:LAVmesh}]
{\includegraphics[width=0.71\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/LAV_mesh.png}}
\end{figure}
\end{exampleblock}

For $p$ increment, can use error estimates to locally run a higher discretization of the numerical scheme on flagged block.

\end{minipage}

\end{frame}


%==========================================================================
\section[Progress]{Progress to date}

\subsection{Poisson}
\begin{frame}[shrink=20]%[allowframebreaks]
\frametitle{Poisson problem in 2 and 3 space dimensions}
\scriptsize
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{Creating and solving linear systems in parallel implementation - trilinos and MPI}
\vspace{-20pt}
\begin{figure}
\label{fig:Poisson}
\centering
\subfloat[\tiny{2D case on $N^2 = 500^2 = 250,000 $ grid points} \label{fig:Poiss2D}]{\includegraphics[width=0.7\textheight]{./figs/Poisson2D.png}}
\subfloat[\tiny{3D case on $N^3 = 100^3 = 1,000,000 $ grid points} \label{fig:Poiss3D}]{\includegraphics[width=0.7\textheight, trim=0cm 0cm 0 2cm,clip=true]{./figs/3D_Poisson.png}}\newline
{\tiny{Solution contours for Poisson problem}}
\end{figure}
\tiny
\vspace{-15pt}
\[ \text{In 2D:} D=[0,1]^2 , f(x,y)=2(x(1-x)+y(1-y)) \text{ is the source term and }  u(x,y) \text{ is the solution to be computed.} \]
\[\text{Using a } 2^{nd} \text{ order centered finite difference scheme= } -\frac{u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}-4*u_{ij}}{h^2}=f_{ij} \]
\vspace{-5pt}
\[\text{In 3D:} D=[0,1]^3,  f(x,y,z)=3(x(1-x)+y(1-y)+z(1-z)) \text{ is the source term and } u(x,y,z)  \text{ is the solution to be computed.}\]
\[ \text{Using a } 2^{nd} \text{ order centered finite difference scheme:} \]
\[{-\frac{u_{i+1,j,k-1}+u_{i-1,j,k-1}+u_{i,j+1,k-1}+u_{i,j-1,k-1} + u_{i+1,j,k+1}+u_{i-1,j,k+1}+u_{i,j+1,k+1}+u_{i,j-1,k+1}-6 u_{ijk}} {h^2} = f_{ijk}} \]

\end{exampleblock}

\end{minipage}
\end{frame}

%---------------------------------------------------------------------------------------------

%------------------------------------------------------------------------

\subsection{LES flame}
\begin{frame}
\frametitle{Performing an LES simulation on SciNET}
\scriptsize
CFFC code familiarization : LES test case - on parallel clusters - SciNET. Job scheduling and post-processing results (tecplot)
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-10pt}
\begin{exampleblock}{Turbulent premixed $CH_4$ flame, $\phi=0.7$. }
\vspace{-20pt}
\begin{figure}
\label{fig:LES}
\centering
\subfloat[\tiny{Flame temp at t=9.0 ms} \label{fig:flametemp}]{\includegraphics[width=0.21\textheight, trim=7cm 0.2cm 2cm 0.2cm,clip=true]{./figs/Flame_temp.png}}
\subfloat[\tiny{FSD at 2.0 ms} \label{fig:fsd2}]{\includegraphics[width=0.3\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/fsd2_0ms.png}}
\subfloat[\tiny{FSD at 4.25 ms} \label{fig:fsd4_25}]{\includegraphics[width=0.3\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/fsd4_25ms.png}}
\subfloat[\tiny{FSD at 7.0 ms } \label{fig:fsd7_0}]{\includegraphics[width=0.3\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/fsd7_0ms.png}}
\subfloat[\tiny{time ave $c_{O_{2}}$} \label{fig:tave}]{\includegraphics[width=0.25\textheight, trim=4cm 0.3cm 2cm 0.5cm,clip=true]{./figs/Time_averaged_c_O2.png}}
%\tiny{\caption{\tiny{Solution contours for Poisson problem}}}
\end{figure}
\vspace{5pt}
\tiny{*FSD, flame surface density is used to model the flame structure, particularly for turbulent premixed flames.}
\vspace{10pt}

Computational costs:
\begin{itemize}
\tiny
\item (a) and (e): 800 procs, 3200 (8x8x8) blocks, ~1.64 x$10^6$ cells, no refinement, ~125x$10^3$ CPU hrs 
\item (b) 800 (8x8x8) blocks, ~410,000 cells,  no refinement
\item (c) 5595 (8x8x8) blocks, ~2.8 million cells, 3 levels of mesh refinement
\item (d) 18531 (8x8x8) blocks, ~9.5 million cells, 3 levels of mesh refinement
\end{itemize}

\end{exampleblock}
\end{minipage}


\end{frame}

%------------------------------------------------------------------------

\subsection{Adjoint runs}
\begin{frame}
\frametitle{Solution of adjoint problem for the Euler equations}
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{Preliminary work with the discrete adjoint - shockcube problem. 27 (20x20x20) blocks}
\vspace{-20pt}
\tiny
\begin{figure}
\label{fig:Blkshockedcube}
\centering
\subfloat[\tiny{$\rho$ at t = 0} \label{fig:BlockRho}]
{\includegraphics[width=0.65\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/20Rho.png}}
\subfloat[\tiny{$\Psi_{\rho}$ at t = 0} \label{fig:BlockadjRho}]
{\includegraphics[width=0.65\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/20RhoAdj.png}}
\end{figure}
\vspace{-10pt}
\begin{itemize}
\scriptsize

\item Adjoint code was written to evaluate $\Psi$ for multiple AMR blocks and multiprocessors
\item Shock cube problem: initial conditions $\rightarrow$ $\frac{\rho_R}{\rho_L} = 8$, $\frac{P_R}{P_L} = 10$. 
\item Selected as functional the average pressure in the shockcube.

\end{itemize}

\end{exampleblock}
\end{minipage}

\end{frame}


%==========================================================================
\section[Timeline]{Timeline}

\subsection[Present]{Work done to date}
\begin{frame}%[allowframebreaks]
\frametitle{Timeline: September 2014  - March 2015}
\scriptsize

\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{Work done to date}

\begin{tabular}{|l|c|} \hline
\multicolumn{1}{|c|}{\bf{Task}} & \multicolumn{1}{|c|}{\bf{Completion Date}} \\

\hline Literature Review & September-October 2014 \\

\hline Trelis Meshing Software & November 2014 \\

\hline CFFC Group Code Flux Jacobian Analysis & December 2014 \\

\hline Trilinos Package solution for & December 2014 \\ Poisson Problem in serial &\\and parallel configurations & \\

\hline Running a current-state LES case of a Turbulent & January 2015\\ Premixed  Methane Flame using PCM-FPI to & \\ get a threshold estimation of solution run time &\\

\hline Implementing the approximate Adjoint Derivative & March 2015 \\  to the Flux Jacobians &\\ testing on Euler Equations  &\\

\hline
\end{tabular}

\end{exampleblock}
\end{minipage}

\end{frame}


\subsection[Future]{Future work}
\begin{frame}%[allowframebreaks]
\frametitle{Future work}
\scriptsize


\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{Projected milestones}

\begin{tabular}{|l|c|} \hline
\multicolumn{1}{|c|}{\bf{Task}} & \multicolumn{1}{|c|}{\bf{Completion Date}} \\

\hline Extension to Mesh adaptation & May 2015\\

\hline Application of Adjoint Problem to Navier Stokes  & June 2015\\

\hline Explicit Filters for High Order FVM implementation  & October 2015\\

\hline Coupling of High Order method with Adjoint-based AMR & December 2015\\

\hline CFD simulation of Cold Flow & January 2016\\

\hline CFD simulation of Laminar Non-Premixed Flame & February 2016\\

\hline CFD simulation of Laminar Premixed Flame & February 2016\\

\hline CFD simulation of Turbulent Non-Premixed Flame & November 2016\\

\hline CFD simulation of Turbulent Premixed Flame & March 2017\\

\hline Thesis write-up & September 2017 \\ 

\hline

\end{tabular}

\end{exampleblock}
\end{minipage}

\end{frame}


%==========================================================================
\begin{frame}
\frametitle{Questions?}
\begin{center}
{\huge Thank You For Your Attention!} \\
\vspace*{1.5cm}
\end{center}
\end{frame}
%==========================================================================

\appendix
\newcounter{finalframe}
\setcounter{finalframe}{\value{framenumber}}

\section{References}
\begin{frame}
\frametitle{References}

\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{}

\begin{tiny}

\begin{thebibliography}{1} %Using the bibtex package is recoended but this should allow you do the bibliograghy ad-hoc.
\beamertemplatetextbibitems
\bibitem{MooreLaw}
BCA Research Blog, \newblock {\url{http://blog.bcaresearch.com/wp-content/uploads/2013/10/Chart-III-8-Moores-Law-Over-199-Years-And-Going-Strong.png}}, Accessed 29-03-2015
\bibitem{Kohler}
K{\"o}hler, M., Boxx, I., Geigle, K. P., and Meier, W., \newblock Simultaneous planar measurements of soot structure and velocity fields in a turbulent lifted jet flame at 3-kHz", Applied Physics B 103 (2), 271-279, 2011  
\bibitem{AdelaideISF}
Adelaide international sooting flame (ISF) workshop, \newblock \url{http://www.adelaide.edu.au/cet/isfworkshop/data-sets/turbulent/}, Accessed 29-03-2015
\bibitem{Pope}
Yang, Y., Pope, S. B., Chen, J. H., \newblock "An LES/PDF study of a turbulent lifted ethylene jet flame in a heated coflow", 8th US National Combustion Meeting, 2013
\bibitem{Graetsch}
Gr{\"a}tsch, T., Bathe, K. J., \newblock "A posteriori error estimation techniques in practical finite element analysis", Journal of Computers and Structures 83, 235–265 , 2005 
\bibitem{Bibb}
Bibb, K., Gnoffo, P. A., Park, M. A., Jones, W. T., \newblock "Parallel, Gradient-Based Anisotropic Mesh Adaptation for Re-entry Vehicle Configurations",  AIAA/ASME Joint Thermophysics and Heat Transfer Conference, AIAA Paper 2006–3579, 2006 

\end{thebibliography}
\end{tiny}

\end{exampleblock}
\end{minipage}


\end{frame}


%==========================================================================================

\section{Backup}
\begin{frame}
\frametitle{Work on the adjoint: Backup slide}
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{Preliminary work with the discrete adjoint - shockcube problem. 8 (20x20x20) blocks}
\tiny
CFFC = Computational Framework for Fluids and Combustion
\vspace{-20pt}
\begin{figure}
\label{fig:shockedcube}
\centering
\subfloat[\tiny{$\rho$ at t = 0} \label{fig:rhoU}]
{\includegraphics[width=0.65\textheight, trim=0cm 0cm 0cm 0cm,clip=true]{./figs/rho_mesh.png}}
\subfloat[\tiny{$\Psi_{\rho}$ at t = 0} \label{fig:adjRhoU}]
{\includegraphics[width=0.65\textheight, trim=0cm 0cm 0 0cm,clip=true]{./figs/rhoAdj_mesh.png}}
\end{figure}
\vspace{-10pt}
\begin{itemize}
\scriptsize
\item Initial conditions: $\frac{\rho_L}{\rho_R} = 8$, $\frac{P_R}{P_L} = 10$. 
\item how the code was modified - multiblock and multiproc for uniform blocks
\item Selected as functional the average pressure in the shockcube.

\end{itemize}

\end{exampleblock}
\end{minipage}

\end{frame}




\begin{frame}%[allowframebreaks]
\frametitle{Turbulent combustion - LES \& DNS comparison cont'd}
Numerical setup of Yang, Pope and Chen [2013]:\newline
\tiny{
Boundary conditions (BCs) are inflow/outflow in $x$ and $y$, while periodic in $z$.\newline
$H = 2$ mm is the jet width.}\newline
Computational domain $=$ cuboid\newline
Streamwise $x$-, transverse $y$-, and spanwise $z$-directions.
\begin{itemize}
\scriptsize
\item DNS 
\begin{enumerate}[(1)]
\scriptsize
\item Grid points $ = 1.3 \times 10^9$.  
\item Computational cost $\approx 14 \times 10^6$ CPU hours.
\item $L_x \times L_y \times L_z = 15H \times 20H \times 3H$ 
\end{enumerate}
\item LES
\begin{enumerate}[(1)]
\scriptsize
\item Grid points $ \approx 8.3 \times 10^3$.  
\item Cost not specified - expected to be several orders of magnitude \textit{lower}.
\item $ L_x \times L_y \times L_z = 15H \times 30H \times 3H$. \newline \tiny{(larger y moves the y-boundary away from central turbulent jet, avoiding the artifact of the Dirichlet boundary condition on entrainment near the jet.)}
\end{enumerate}
\end{itemize}
\vspace{10pt}
\scriptsize
Mean temperature results show agreement between LES and DNS at $\frac{x}{H} = 6$. \newline LES values lower than DNS for $\frac{x}{H} = 12$.\newline
Anticipate this to improve for increased LES mesh resolution.

\end{frame}


\begin{frame}%[allowframebreaks]
\frametitle{Turbulent combustion - Example flame}
\scriptsize
[K{\"o}hler 2006] \cite{Kohler, AdelaideISF}
\begin{minipage}[0.5\textheight]{\textwidth}
\begin{columns}[T]
\begin{column}{0.65\textwidth}
\vspace{10pt}

\tiny{Lifted turbulent Ethylene ($C_2H_4$) jet flame issuing into a concentric co-flow of air.
Zone between flame-base and nozzle may have partial premixing.  }
\begin{itemize}%[<+->]
\tiny
%\setlength\itemsep{-0.7mm}
\item Fuel temp, air temp and pressure near std.
\item Dimensions: nozzle diameter = 2.0 mm; co-flow air annulus diameter = 140 mm\\
\item Exit fuel Reynolds number: $\num{10e3}$
\item Air mass flow: 320 g/min 
\item Mean fuel jet velocity: 44 m/s 
\end{itemize}
\end{column}
\begin{column}{0.3\textwidth}
\vspace{0pt}
\includegraphics[height=1\textwidth]{./figs/dlrflame.png}
\end{column}
\end{columns}
\end{minipage}

\vspace{10pt}
\scriptsize
Turbulent combustion: practical reactive flows almost always involve turbulence.
\newline \newline
Simulation techniques: 
\begin{enumerate}[(a)]
\item DNS resolves all the scales 
\item LES models sub-filter scales (SFS) while resolving larger scales 
\item RANS models all turbulent scales 
\end{enumerate}
Large eddy simulation (LES): higher accuracy than Reynolds averaged Navier Stokes (RANS) $\rightarrow$ lower cost (time, resources) than direct numerical simulation (DNS).


\end{frame}



\begin{frame}%[allowframebreaks]
\frametitle{High order finite volume method}
\begin{minipage}[t][1\textheight]{1\textwidth}
\vspace{-20pt}
\begin{exampleblock}{Error reduction via p}
\tiny
\begin{block}{Integral Form of the Governing Equations}
     \[
      \frac{\mathrm{d}\overline{\mathbf{U}}}{\mathrm{d}t} = 
      - \frac{1}{V} \oiint_A \left( \vec{\mathcal{F}}^{\rm I} - 
      \vec{\mathcal{F}}^{\rm V} \right) \cdot \hat{n} \mathrm{d}\mathcal{A} + 
      \overline{\mathbf{S}}
     \] 
    Using a two-dimensional Gauss quadrature integration rule:
    \[  \frac{\mathrm{d}\overline{\mathbf{U}}_{ijk}}{\mathrm{d}t} = -
       \frac{1}{{V}_{ijk}} \sum_{l=1}^{N_f}     
      \sum_{m=1}^{N_{GF}} \left( \omega \left(\vec{\mathcal{F}^{\mathrm{I}}} - 
      \vec{\mathcal{F}^{\mathrm{V}}} \right)\cdot \hat{n} {A} \right)_{ijk,l,m} 
      + \sum_{n=1}^{N_{GV}} \left( \omega_n {\mathbf{S}} \right)_{i,j,k,n}      
       = \overline{\mathbf{R}}_{ijk}  \left( \overline{\mathbf{U}} \right) \]
 
\end{block}

\begin{enumerate}[(a)]
\tiny
\item High order methods  generally $ > 2^{nd}$ order accuracy, reduce numerical error between PDE governing equations and discretized formulations.
\item Discretized scheme expressed in matrix-vector form: [Northrup 2013] GMRES solver.\item High $p$ $\rightarrow$ more the quadrature points ($ N_G $ with weights $ \omega $).
\item (Gauss-Legendre) quadrature rules $\rightarrow$ reference elements $\rightarrow$ computational elements via mapping functions
\item Evaluate the inviscid and viscous fluxes: apply weights to quadrature points
\item Evaluate source vector, which adds effects of turbulence and chemistry in reacting flows
\item Apply appropriate time-marching, e.g. RK4 suitable to high order methods.
\item Other groups researching high order methods in LES: Ihme (Stanford) and Poinsot (CERFACS)
\end{enumerate}
\end{exampleblock}
\end{minipage}


\end{frame}

%==========================================================================





%==========================================================================

\setcounter{framenumber}{\value{finalframe}}




\end{document}




%==========================================================================